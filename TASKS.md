# WebFlux SDK 개발 로드맵 및 태스크

> RAG 시스템을 위한 완전한 웹 콘텐츠 처리 SDK 구축

## 🎯 프로젝트 개요 및 목표

**WebFlux**는 순수 RAG 전처리 SDK로서, 웹 콘텐츠를 RAG 시스템에 최적화된 구조화된 청크로 변환하는 **.NET 9 SDK**입니다.

### 핵심 가치 제안
- **인터페이스 제공자**: 구현체는 소비 애플리케이션이 선택
- **AI 공급자 중립**: OpenAI, Anthropic, Azure 등에 종속되지 않음
- **Clean Architecture**: 의존성 역전으로 확장성 보장

## 📚 연구 기반 핵심 인사이트

### 1. RAG 성능의 결정 요인
> **"RAG 시스템의 전체 성능을 결정하는 가장 중요한 단일 요인은 데이터 수집 파이프라인의 품질"**

- 파싱 및 청킹 전략이 다운스트림 작업 성능에 **10-20% 차이** 유발
- 법률 분야 사례: 고급 청킹으로 답변 정확도 **23% 증가**, 환각 **41% 감소**
- 맥락적 검색으로 검색 실패율 **49-67% 감소**

### 2. 청킹 전략의 임팩트
- **고정 크기**: 간단하지만 의미론적 경계 무시
- **구조-인식**: 높은 맥락 보존, 논리적 일관성
- **의미론적**: 가장 높은 의미론적 일관성
- **에이전틱**: 최고 성능이지만 높은 비용

### 3. 아키텍처 원칙
- **하이브리드 마이크로서비스**: Python 생태계와 .NET 통합
- **스트리밍 최적화**: AsyncEnumerable 활용
- **병렬 처리**: Threading.Channels 기반 고성능 처리

## 🚀 다단계 페이즈 로드맵

### Phase 1: Foundation (기반 구축) - 4주
> 핵심 인터페이스와 기본 인프라 구축

**목표**: 개발 가능한 기반 인프라와 Mock 서비스 완성

#### 주요 태스크
- **1.1** 프로젝트 구조 및 패키징 설정
- **1.2** 핵심 인터페이스 정의
- **1.3** 도메인 모델 및 데이터 구조 정의
- **1.4** DI 컨테이너 및 서비스 등록
- **1.5** Mock 서비스 구현 (테스트용)
- **1.6** 기본 테스트 프레임워크 설정

### Phase 2: Core Processing (핵심 처리) - 6주
> 웹 크롤링과 콘텐츠 추출의 핵심 기능 구현

**목표**: 기본적인 웹 → 청크 파이프라인 완성

#### 주요 태스크
- **2.1** 웹 크롤러 엔진 구현
- **2.2** 콘텐츠 추출기 구현 (HTML, Markdown)
- **2.3** 기본 청킹 전략 (FixedSize, Paragraph)
- **2.4** 파이프라인 오케스트레이션
- **2.5** 진행률 리포팅 시스템
- **2.6** 기본 통합 테스트

### Phase 3: Advanced Chunking (고급 청킹) - 8주
> 연구 기반 고급 청킹 전략 구현

**목표**: 성능 향상을 위한 고급 청킹 전략 완성

#### 주요 태스크
- **3.1** 구조-인식 청킹 (Smart) 구현
- **3.2** 의미론적 청킹 (Semantic, Intelligent) 구현
- **3.3** Auto 전략 (자동 최적화) 구현
- **3.4** MemoryOptimized 전략 구현
- **3.5** 청킹 전략 성능 비교 및 벤치마킹
- **3.6** 다중 청킹(Poly-Chunking) 지원

### Phase 4: Performance & Optimization (성능 최적화) - 6주
> 엔터프라이즈급 성능 달성

**목표**: 100페이지/분 크롤링 성능 달성

#### 주요 태스크
- **4.1** 병렬 처리 엔진 구현 (CPU 코어별 동적 스케일링)
- **4.2** 스트리밍 최적화 (AsyncEnumerable)
- **4.3** 지능형 LRU 캐시 시스템
- **4.4** 메모리 백프레셔 제어
- **4.5** 성능 모니터링 및 메트릭
- **4.6** 부하 테스트 및 성능 검증

### Phase 5: Multimodal & Advanced Features (멀티모달 및 고급 기능) - 8주
> 차세대 RAG 기능 구현

**목표**: 이미지-텍스트 통합 처리 및 평가 프레임워크 완성

#### 주요 태스크
- **5.1** 이미지-텍스트 변환 (텍스트 기반화)
- **5.2** 표 데이터 선형화 처리
- **5.3** 고급 콘텐츠 추출기 (JSON, XML, RSS)
- **5.4** 평가 프레임워크 구현
- **5.5** 맥락적 검색 최적화
- **5.6** 프로덕션 준비 (문서, 예제, NuGet 패키징)

## 📋 상세 태스크 분석

### Phase 1 상세 태스크

#### 1.1 프로젝트 구조 및 패키징 설정
**목표**: .NET 9 기반 SDK 프로젝트 구조 구축
- [ ] `src/WebFlux/` 메인 라이브러리 프로젝트 생성
- [ ] `src/WebFlux.Tests/` 단위 테스트 프로젝트
- [ ] `samples/` 샘플 애플리케이션 프로젝트
- [ ] NuGet 패키징 설정 (.csproj, nuspec)
- [ ] CI/CD 파이프라인 기초 설정

**완료 기준**: `dotnet build` 성공, NuGet 패키지 생성 가능

#### 1.2 핵심 인터페이스 정의
**목표**: 연구 기반 핵심 서비스 인터페이스 정의
- [ ] `ITextCompletionService` - LLM 텍스트 완성 인터페이스
- [ ] `IImageToTextService` - 이미지-텍스트 변환 인터페이스
- [ ] `IWebContentProcessor` - 메인 웹 콘텐츠 처리 인터페이스
- [ ] `ICrawler` - 웹 크롤링 인터페이스
- [ ] `IContentExtractor` - 콘텐츠 추출 인터페이스
- [ ] `IChunkingStrategy` - 청킹 전략 인터페이스

**완료 기준**: 모든 인터페이스 XML 문서화 완료, 컴파일 성공

#### 1.3 도메인 모델 및 데이터 구조 정의
**목표**: 핵심 데이터 모델 정의
- [ ] `WebContentChunk` - 청크 데이터 모델
- [ ] `CrawlOptions` - 크롤링 옵션
- [ ] `ChunkingOptions` - 청킹 옵션
- [ ] `WebContentMetadata` - 메타데이터 모델
- [ ] `ProcessingResult<T>` - 결과 래퍼 모델
- [ ] `ProgressInfo` - 진행률 정보 모델

**완료 기준**: 모든 모델 단위 테스트 작성 완료

### Phase 2 상세 태스크

#### 2.1 웹 크롤러 엔진 구현
**목표**: robots.txt 준수하는 지능형 크롤러 구현
- [ ] `BreadthFirstCrawler` - 너비 우선 크롤링
- [ ] `DepthFirstCrawler` - 깊이 우선 크롤링
- [ ] `SitemapCrawler` - sitemap.xml 기반 크롤링
- [ ] Robots.txt 파서 및 준수 로직
- [ ] 중복 URL 필터링 (해시 기반)
- [ ] 요청 간 지연 제어

**완료 기준**: 100개 페이지 크롤링 성공, robots.txt 준수 검증

#### 2.2 콘텐츠 추출기 구현
**목표**: 다양한 웹 콘텐츠 형식 지원
- [ ] `HtmlContentExtractor` - HTML → 마크다운 변환
- [ ] `MarkdownContentExtractor` - 마크다운 직접 처리
- [ ] `JsonContentExtractor` - JSON 데이터 처리
- [ ] 메타데이터 추출 (title, description, keywords)
- [ ] 이미지 URL 수집 (멀티모달 준비)

**완료 기준**: 각 형식별 추출 테스트 통과, 메타데이터 정확성 검증

### Phase 3 상세 태스크

#### 3.1 구조-인식 청킹 (Smart) 구현
**목표**: 연구에서 강조한 구조 보존 청킹
- [ ] HTML 헤더 기반 분할 (`<h1>`, `<h2>`, `<h3>`)
- [ ] 마크다운 헤더 기반 분할 (`#`, `##`, `###`)
- [ ] 테이블 경계 인식 및 보존
- [ ] 코드 블록 경계 인식
- [ ] 헤더 텍스트 메타데이터 첨부

**완료 기준**: 기술 문서 청킹에서 맥락 보존 95% 달성

#### 3.2 의미론적 청킹 (Semantic, Intelligent) 구현
**목표**: 연구 성과 기반 고급 청킹
- [ ] 문장 단위 임베딩 생성
- [ ] 코사인 유사도 기반 분기점 탐지
- [ ] 의미론적 이중 패스 병합 (과도한 단편화 방지)
- [ ] LLM 기반 지능형 청킹 (실험적)
- [ ] 임계값 자동 조정

**완료 기준**: 의미론적 일관성 평가 점수 85% 이상

### Phase 4 상세 태스크

#### 4.1 병렬 처리 엔진 구현
**목표**: 연구에서 제시한 성능 목표 달성
- [ ] Threading.Channels 기반 작업 큐
- [ ] CPU 코어별 동적 워커 스케일링
- [ ] 작업 분산 로드 밸런싱
- [ ] 예외 처리 및 재시도 로직
- [ ] 리소스 모니터링 및 백프레셔

**완료 기준**: 100페이지/분 크롤링 성능 달성

### Phase 5 상세 태스크

#### 5.1 이미지-텍스트 변환 (텍스트 기반화)
**목표**: 연구에서 제시한 멀티모달 처리
- [ ] 이미지 URL 탐지 및 수집
- [ ] `IImageToTextService` 통합
- [ ] 프롬프트 엔지니어링 (고품질 설명 생성)
- [ ] 이미지 설명-텍스트 맥락 연관
- [ ] 통합 인덱싱 지원

**완료 기준**: 이미지 포함 웹페이지 처리 성공, 설명 품질 검증

## ✅ 완료 기준 및 검증 방법

### Phase별 완료 기준

#### Phase 1 완료 기준
- [ ] 모든 핵심 인터페이스 정의 완료
- [ ] Mock 서비스로 기본 파이프라인 동작 검증
- [ ] 단위 테스트 커버리지 90% 이상
- [ ] API 문서 자동 생성 설정 완료

#### Phase 2 완료 기준
- [ ] 실제 웹사이트 크롤링 및 청킹 성공
- [ ] 기본 청킹 전략 성능 벤치마크 완료
- [ ] 통합 테스트 통과 (end-to-end)
- [ ] 예외 상황 처리 검증

#### Phase 3 완료 기준
- [ ] 7가지 청킹 전략 모두 구현 완료
- [ ] 청킹 전략 비교 성능 리포트 작성
- [ ] Auto 전략의 자동 선택 정확도 85% 이상
- [ ] 메모리 사용량 최적화 검증

#### Phase 4 완료 기준
- [ ] 목표 성능 달성 (100페이지/분)
- [ ] 메모리 사용량 최적화 (페이지 크기 1.5배 이하)
- [ ] 장시간 안정성 테스트 통과 (24시간)
- [ ] 부하 테스트 결과 문서화

#### Phase 5 완료 기준
- [ ] 멀티모달 처리 완전 구현
- [ ] 평가 프레임워크로 품질 검증
- [ ] 프로덕션 문서 및 예제 완성
- [ ] NuGet 패키지 퍼블리시 준비 완료

## 🔗 의존성 및 우선순위

### 크리티컬 패스
1. **Phase 1 → Phase 2**: 인터페이스 정의 완료 후 구현 시작
2. **Phase 2 → Phase 3**: 기본 청킹 완료 후 고급 청킹 구현
3. **Phase 3 → Phase 4**: 청킹 전략 완성 후 성능 최적화
4. **Phase 4 → Phase 5**: 성능 안정화 후 고급 기능 추가

### 병렬 진행 가능 영역
- 문서 작성과 구현 병렬 진행
- 테스트 작성과 기능 구현 병렬 진행
- 성능 최적화와 고급 기능 일부 병렬 진행

## ⚠️ 리스크 및 완화 방안

### 기술적 리스크
1. **성능 목표 미달성**
   - 완화: Phase 4에서 충분한 성능 테스트 기간 확보
   - 백업: 점진적 성능 개선 전략 수립

2. **의미론적 청킹 품질 이슈**
   - 완화: 다양한 임계값 및 알고리즘 실험
   - 백업: 구조-인식 청킹으로 대체 가능

3. **멀티모달 처리 복잡도**
   - 완화: Phase 5를 선택적 기능으로 설계
   - 백업: 텍스트 처리 우선 완성

### 프로젝트 리스크
1. **일정 지연**
   - 완화: 2주마다 진행 상황 점검
   - 백업: Phase별 최소 기능 우선 구현

2. **요구사항 변경**
   - 완화: 인터페이스 기반 설계로 변경 대응력 확보
   - 백업: Clean Architecture로 확장성 보장

## 📊 성공 지표

### 정량적 지표
- **성능**: 100페이지/분 크롤링 달성
- **품질**: 청크 완성도 81%, 컨텍스트 보존 75% 달성
- **메모리**: 페이지 크기 1.5배 이하 메모리 사용
- **테스트**: 코드 커버리지 90% 이상

### 정성적 지표
- RAG 시스템 통합 용이성
- 개발자 친화적 API 설계
- 확장 가능한 아키텍처
- 포괄적인 문서화

---

**다음 단계**: 이 로드맵을 바탕으로 `docs/` 디렉터리에 상세 설계 문서를 작성하여 개발팀이 구현할 수 있는 구체적인 설계 가이드를 제공합니다.